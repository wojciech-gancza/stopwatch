<html>
  <head>
  </head>
 
  <body>
  <!--form name="f1"-->
    <div style="width: 480px; height: 320px; background: #80ff80; ">
	  <table width="100%">
	    <tr>
		  <td>Cell 1 1</td>
		  <td>Cell 2 1</td>
		</tr>
	    <tr>
		  <td>Cell 1 2</td>
		  <td style="background: #ffff80; text-align: right; font-size: 12pt; vertical-aligh: top">
		    
			<a id="x1anhr" href="javascript: editCell();" style="font-size: 12pt; text-decoration: none">Cell 2 2 xxx</a>
			 
			<div id="x1edit" style="display: none; position: relative">
		        <input type="text" onFocusOut="leaveCell(true)" onKeyDown="cellKey(event)"
					   id="x1input" name="x1input" 
					   style="width: 100px; font-size: 12pt; text-align: right"> 
			</div>
			
		  </td>
		</tr>
	  </table>
	</div>
    <script>

function convertNumber(txt) {
	number = 0;
	for (i=0; i<txt.length; ++i) {
		character = txt.charCodeAt(i);
		if (character < 48) 
			return -1;
		digit = character - 48;
		if (digit >= 10)
			return -1; 
		number = 10 * number + digit;
	};
	return number;
}

function convertTimeString(txt) {
	parts = txt.split(':');
	if (parts.length == 1)
		return 60 * convertNumber(parts[0]);
	if (parts.length == 2)
		return 60 * 60 * convertNumber(parts[0]) + 60 * convertNumber(parts[1]);
	if (parts.length == 3)
		return 60 * 60 * convertNumber(parts[0]) + 60 * convertNumber(parts[1]) + convertNumber(parts[2]);
	return -1;
}

function convertWordToTime(txt) {
	txt = txt.trim();
	if (txt == "")
		return -1;
		
	lastCharacter = txt.slice(-1);
	allButLast = txt.slice(0, -1);
	
	if (lastCharacter == "d")
		return 24*60*60*convertNumber(allButLast);
	if (lastCharacter == "h")
		return 60*60*convertNumber(allButLast);
	if (lastCharacter == "m")
		return 60*convertNumber(allButLast);
	if (lastCharacter == "s")
		return convertNumber(allButLast);
	return convertTimeString(txt);	
}

function convertTimeDuration(txt) {
	words = txt.split(' ')
	result = 0;
	for (j=0; j<words.length; ++j) {
		value = convertWordToTime(words[j])
		if (value < 0) 
			return -1;
		result = result + value;
	}
	return result;
}
	
function convertTimeToOneField(seconds) {
	return (seconds < 10 ? "0" : "") + seconds.toString();
}

function convertTimeToTwoFields(seconds) {
	return convertTimeToOneField(Math.floor(seconds/60)) + ":" + convertTimeToOneField(seconds%60);
}

function convertTimeToThreeFields(seconds) {
	return convertTimeToOneField(Math.floor(seconds/3600)) + ":" + convertTimeToTwoFields(seconds%3600);
}

function convertToTimeText(seconds) {
	if (seconds < 0) 
		return "-" + convertToTimeText(-seconds);
	if (seconds < 60)
		return convertTimeToOneField(seconds)
	else if (seconds < 60*60)
		return convertTimeToTwoFields(seconds);
	else if (seconds < 60*60*24)
		return convertTimeToThreeFields(seconds);
	else
		return (Math.floor(seconds/(24*60*60))).toString() + "d " + convertTimeToThreeFields(seconds%(24*60*60));
};

//--------------------------------------------
	
function editCell() {
	document.getElementById("x1anhr").style.display = "none";
	document.getElementById("x1edit").style.display = "inline";
	document.getElementById("x1input").value = document.getElementById("x1anhr").innerHTML;
	document.getElementById("x1input").focus();
	document.getElementById("x1input").select();
}

function leaveCell(store) {
	document.getElementById("x1anhr").style.display = "inline";
	document.getElementById("x1edit").style.display = "none";
	if (store) {
		value = document.getElementById("x1input").value;
		duration = convertTimeDuration(value)
		if (duration >= 0) {
			var txt = convertToTimeText(duration);
			document.getElementById("x1anhr").innerHTML = txt;
		}
	}
}

function cellKey(event) {
	if (event.keyCode == 13) {
		event.keyCode = 0;
		leaveCell(true);
	}
	if (event.keyCode == 27) {
		event.keyCode = 0;
		document.getElementById("x1input").value = document.getElementById("x1anhr").innerHTML;
		leaveCell(false);
	}
}
	</script>
  <!--/form-->
  </body>
</html>